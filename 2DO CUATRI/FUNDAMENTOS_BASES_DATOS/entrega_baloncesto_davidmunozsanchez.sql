CREATE TABLE EQUIPOS (
    COD_E CHAR(3) CONSTRAINT PK_CODIGO_EQUIPO PRIMARY KEY,
    LOCALIDAD VARCHAR(30) NOT NULL,
    NOM_E VARCHAR(15) NOT NULL
);

CREATE TABLE JUGADOR (
    CODJ CHAR(3) CONSTRAINT PK_CODIGO_JUGADOR PRIMARY KEY,
    NOMBREJ VARCHAR(30) NOT NULL,
    COD_E CHAR(3) NOT NULL
);

CREATE TABLE ENCUENTROS (
    COD_E_LOCAL CHAR(3) REFERENCES EQUIPOS(COD_E),
    COD_E_VISITANTE CHAR(3) REFERENCES EQUIPOS(COD_E),
    PLOCAL NUMBER(3) DEFAULT 0 CHECK (PLOCAL >= 0) NOT NULL,
    PVISITANTE NUMBER(3) DEFAULT 0 CHECK (PVISITANTE >= 0) NOT NULL,
    FECHA DATE NOT NULL,
    PRIMARY KEY (COD_E_LOCAL, COD_E_VISITANTE)
);

CREATE TABLE FALTAS (
    COD_E_LOCAL CHAR(3),
    COD_E_VISITANTE CHAR(3),
    CODJ CHAR(3) REFERENCES JUGADOR(CODJ),
    NUM_FALTAS NUMBER(1) DEFAULT 0 CHECK (NUM_FALTAS BETWEEN 0 AND 5) NOT NULL,
    PRIMARY KEY (COD_E_LOCAL, COD_E_VISITANTE, CODJ),
    FOREIGN KEY (COD_E_LOCAL, COD_E_VISITANTE) REFERENCES ENCUENTROS(COD_E_LOCAL, COD_E_VISITANTE)
);

CREATE TABLE PERTENECE(
    CODJ CHAR(3) REFERENCES JUGADOR(CODJ) PRIMARY KEY,
    COD_E CHAR(3) REFERENCES EQUIPOS(COD_E)
);

--Cuando me di cuenta ya lo tenia rellenado como si fuera de futbol
INSERT INTO JUGADOR VALUES ('J3','Camavinga', 'E1');
INSERT INTO JUGADOR VALUES ('J1','Curtois', 'E1');

INSERT INTO EQUIPOS VALUES ('E1','Madrid', 'Real Madrid');
INSERT INTO EQUIPOS VALUES ('E2','Azuaga', 'CD Azuaga');
--He aniadido el barcelona para en la tabla faltas no me dejara insertar la combinacion Real Madrid-Barcelona, ya que no hay un encuentro registrado de ese tipo
INSERT INTO EQUIPOS VALUES ('E3','Barcelona', 'FC Barcelona');

INSERT INTO PERTENECE VALUES('J1','E1');
INSERT INTO PERTENECE VALUES('J3','E1');

INSERT INTO ENCUENTROS VALUES('E1','E2',56,89,'29/10/2001');
INSERT INTO ENCUENTROS VALUES('E2','E1',56,89,'29/10/2003');

INSERT INTO FALTAS VALUES('E1','E2','J3',1);
INSERT INTO FALTAS VALUES('E2','E1','J1',0);

COMMIT;

